<!--
    Chai PCR - Software platform for Open qPCR and Chai's Real-Time PCR instruments.
    For more information visit http://www.chaibio.com

    Copyright 2016 Chai Biotechnologies Inc. <info@chaibio.com>

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<menu-overlay>
  <div class="edit-stage-step-container" ng-controller="StageStepCtrl">
    <div class="top-half noselect">
      <!-- Top part -->
      <header-status experiment-id="protocol.id">
        <div class="stripes" toggle-sidemenu>
          <div class="stripe"></div>
          <div class="stripe"></div>
          <div class="stripe"></div>
        </div>
      </header-status>
      <!-- <div class="name-on-top">
        <div class="stripe-container">
          <div class="stripes">
            <a toggle-sidemenu>
              <div class="stripe"></div>
              <div class="stripe"></div>
              <div class="stripe"></div>
            </a>
          </div>
        </div>
        <div class="top-exp-name">
          {{protocol.name}}
        </div>
        <div class="where-m-I">
          <scroll-on-top ng-if="showScrollbar" width="{{scrollWidth}}" left="{{scrollLeft}}"></scroll-on-top>
        </div>
        <div ng-if="false" class="undo-container SH">
          <button id="undo-action">UNDO</button>
        </div>
      </div> -->
      <!-- Top part End-->
      <!-- Canvas Part -->
      <div class="canvas-containing">
        <canvas class="canvasClass" id="canvas"></canvas>
        <div class="canvas-loading">LOADING
          <ellipsis-animated></ellipsis-animated>
        </div>
        <!--<div class="exp_completed_overlay" ng-show="exp_completed"></div> -->
      </div>
    </div>
    <!-- Canvas Part End-->
    <!-- bottom-half-->
    <div protocol-screen-center-bottom-half class="bottom-half noselect">
      <arrow class="previous" action="previous" ng-click="arrowClicked()"></arrow>
      <div class="middle-ground">
        <div class="first-data-row">
          <general></general>
          <summary-mode></summary-mode>
        </div>
        <div class="data-boxes-container">
          <div class="data-box-container-summary">
            <!--First two data boxes -->
            <div class="data-box-container-summary-scroll">
              <div class="data-boxes temperature-change">
                <div class="name-board SH">TEMPERATURE DETAILS</div>
                <temperature caption="Temperature" help-text="[0-100     ºC]" unit="ºC" reading="step.temperature" action="WOWaction(edit)"></temperature>
                <ramp-speed caption="Ramp Speed" help-text="[0-6&nbsp;&nbsp;ºC/s]" unit="ºC/s" reading="step.ramp.rate"></ramp-speed>
                <hold-duration caption="Hold Duration" help-text="[0:00-5:00]" reading="step.hold_time" pause="! step.pause"></hold-duration>
              </div>
              <div class="data-boxes auto-delta">
                <div class="name-board">
                  <div class="toggle-container">
                    <auto-delta-toggle data="stage.auto_delta" type="{{stage.stage_type}}" call="changeDelta"></auto-delta-toggle>
                  </div>
                  <auto-delta-caption type="{{stage.stage_type}}"></auto-delta-caption>
                </div>
                <start-on-cycle caption="Start On Cycle" delta="stage.auto_delta" reading="stage.auto_delta_start_cycle"></start-on-cycle>
                <temp caption="Δ Temp" unit="ºC" delta="stage.auto_delta" reading="step.delta_temperature">
                  <capsule func="changeDeltaTemperature" delta="{{stage.auto_delta}}" data="step.delta_temperature"></capsule>
                </temp>
                <time caption="Δ Time" delta="stage.auto_delta" reading="step.delta_duration_s">
                  <capsule func="changeDeltaTime" delta="{{stage.auto_delta}}" data="step.delta_duration_s"></capsule>
                </time>
              </div>
              <div class="data-boxes exp-overview">
                <div class="name-board SH">EXPERIMENT OVERVIEW</div>
                <summary-mode-item caption="Stages" reading="{{fabricStep.parentStage.parent.allStageViews.length}}"></summary-mode-item>
                <summary-mode-item caption="Steps" reading="{{fabricStep.parentStage.parent.allStepViews.length}}"></summary-mode-item>
                <summary-mode-item caption="Est. Time to Complete" reading="{{protocol.protocol.estimate_duration | toHour}}"></summary-mode-item>
              </div>
              <div class="data-boxes exp-metadata">
                <div class="name-board SH">EXPERIMENT META DATA</div>
                <summary-mode-item caption="Created on" reading="{{protocol.created_at | amDateFormat: 'MMM D, YYYY hh:mm A'}}"></summary-mode-item>
                <summary-mode-item ng-if="protocol.started_at" caption="Run on" reading="{{protocol.started_at | amDateFormat: 'MMM D, YYYY hh:mm A'}}"></summary-mode-item>
              </div>
            </div>
          </div>
          <!--First two data boxes -->
          <div class="data-boxes edit-stage-step">
            <div class="name-board SH">EDIT STEPS + STAGES</div>
            <actions></actions>
          </div>
        </div>
        <stage-type-popup ng-show="actionPopup && !infiniteHoldStage"></stage-type-popup>
        <div class="exp_completed_overlay" ng-show="exp_completed"></div>
      </div>
      <arrow class="next" action="next" ng-click="arrowClicked()"></arrow>
      <div class="exp-info-bar" sticky-footer>
        <status-bar experiment-id="protocol.id"></status-bar>
      </div>
    </div>
  </div>
</menu-overlay>
