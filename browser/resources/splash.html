<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Welcome to Open qPCR</title>
<link rel="stylesheet" type="text/css" href="stylesheets/static.css">
<script src="javascripts/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="javascripts/main.js" type="text/javascript"></script>
<script type="text/javascript" language="javascript">
<!--
$(document).ready(function(){

	// This part was written to align the image and no more used.
	/*setTimeout(function() {
		$('#splash').center()
	}, 1);
    $(window).bind('resize', function() {
        $('#splash').center({transition:0});
    });*/

	var interval = setInterval(function () {
		checkConnection();
	}, 10000);



	var checkConnection = function() {
		$.get("http://localhost:8000/network/eth0")
			.done(function(data) {
				if(data.state) {
					//$("#ip-address").text("IP ADDRESS: " + data.state.address);
					$(".span-message").hide();
					$(".ip-text").show().text("IP ADDRESS: ");
					$(".ip-value").show().text(data.state.address);
				} else {
					$(".ip-text").hide();
					$(".ip-value").hide();
					$(".span-message").show().text("No ethernet connection.")
				}
			})
			.fail(function() {
				$(".ip-text").hide();
				$(".ip-value").hide();
				$(".span-message").show().text("No ethernet connection.");
			});
	}

	checkConnection();

	var getDevice = function() {
		$.get("http://localhost:80/device")
		.done(function(data) {
			if(data.software.version) {
				$(".version-text").text("V. ");
				$(".version-value").text(data.software.version);
				clearInterval(insure);
			}
			if(data.serial_number) {
				$(".serial-value").text(data.serial_number);
			}
		})
		.fail(function() {

		});

		/*$.ajax({
			url: "http://localhost/device",
			contentType: 'application/json',
			type: 'GET',
			dataType: 'jsonp',
			jsonpCallback: 'updateRecordDisplay'
			})
			.done(function(data) {
				console.log(data);
			//that.set("statusData", data);
			//that.trigger("data-updated");
			});
	*/
	}

	getDevice();

	var insure = setInterval(function () {
		getDevice();
	}, 10000);

});
//-->
</script>
</head>

<body>
<div id="splash">
	<img src="images/openqpcr_logo_dark.svg">
</div>
<div id="ip">
	<div id="ip-address">
		<span class="span-text ip-text"></span>
		<span class="span-value ip-value"></span>
		<span class="span-message ip-message"></span>
	</div>
	<div id="version">
		<span class="span-text version-text">&nbsp;</span>
		<span class="span-value version-value"></span>
	</div>
	<div id="serial">
		<span class="span-text serial-text">SERIAL:</span>
		<span class="span-value serial-value"></span>
	</div>
</div>
</body>
</html>
